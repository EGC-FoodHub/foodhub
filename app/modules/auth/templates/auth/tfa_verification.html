{% extends "base_template.html" %} {% block title %}Two-Factor Authentication{%
endblock %} {% block content %}

<h1 class="h2 mb-3"><b>Two-Factor Authentication</b></h1>

<div class="row">
  <div class="col-12">
    {% if qrcode %}
    <div class="mb-4 text-center">
      <p>Scan this QR code with your authenticator app:</p>
      <img
        src="data:image/png;base64,{{ qrcode }}"
        alt="2FA QR Code"
        class="img-fluid"
        style="max-width: 200px"
      />
    </div>
    {% endif %}

    <form action="" method="post" novalidate>
      {{ form.hidden_tag() }}

      <div class="row">
        <div class="col-md-6 col-lg-6 col-xs-12">
          <div class="mb-3">
            {{ form.code.label(class="form-label") }} {{
            form.code(class="form-control", placeholder="Enter 6-digit code") }}
            {% for error in form.code.errors %}
            <span style="color: red">{{ error }}</span>
            {% endfor %}
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-lg-6 col-12">
          {{ form.submit(class="btn btn-primary") }}
        </div>
      </div>

      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %}
      <div class="mt-3">
        {% for category, message in messages %}
        <div class="alert alert-{{ category }}">{{ message }}</div>
        {% endfor %}
      </div>
      {% endif %} {% endwith %}
    </form>
  </div>
</div>
<div class="row">
  <div class="col-lg-6 col-12">
    {% if error %}

    <div class="mt-3">
      <p style="color: red"><strong>Error:</strong> {{ error }}</p>
    </div>

    {% endif %}
  </div>
</div>
{% endblock %}
